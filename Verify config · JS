require('dotenv').config();

/**
 * Script de verificaciÃ³n de configuraciÃ³n
 * Ejecuta este archivo para verificar que todos los roles estÃ©n configurados correctamente
 * 
 * Uso: node verify-config.js
 */

const config = require('./config/config');

console.log('\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
console.log('ğŸ” VERIFICACIÃ“N DE CONFIGURACIÃ“N - BOT DE TICKETS');
console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n');

// Verificar roles
console.log('ğŸ“‹ ROLES CONFIGURADOS:\n');

const roles = {
    'Support': process.env.SUPPORT_ROLE_ID,
    'Finance': process.env.FINANCE_ROLE_ID,
    'Moderator': process.env.MODERATOR_ROLE_ID,
    'Admin': process.env.ADMIN_ROLE_ID,
    'Senior Admin': process.env.SENIOR_ADMIN_ROLE_ID,
    'Staff General': process.env.STAFF_ROLE_ID
};

let missingRoles = [];
let configuredRoles = 0;

for (const [name, id] of Object.entries(roles)) {
    if (id && id.trim() !== '') {
        console.log(`âœ… ${name.padEnd(20)} â†’ ${id}`);
        configuredRoles++;
    } else {
        console.log(`âŒ ${name.padEnd(20)} â†’ NO CONFIGURADO`);
        missingRoles.push(name);
    }
}

console.log('\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n');

// Verificar tipos de tickets y sus roles
console.log('ğŸ« TIPOS DE TICKETS Y ROLES REQUERIDOS:\n');

for (const [key, ticketType] of Object.entries(config.ticketTypes)) {
    console.log(`${ticketType.emoji} ${ticketType.label}`);
    console.log(`   Roles requeridos: ${ticketType.roles.join(', ')}`);
    
    let allRolesConfigured = true;
    for (const roleKey of ticketType.roles) {
        const roleId = config.roles[roleKey];
        if (!roleId || roleId.trim() === '') {
            console.log(`   âŒ Falta configurar: ${roleKey.toUpperCase()}_ROLE_ID`);
            allRolesConfigured = false;
        }
    }
    
    if (allRolesConfigured) {
        console.log(`   âœ… Todos los roles configurados correctamente`);
    }
    console.log('');
}

console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n');

// Verificar canales
console.log('ğŸ“º CANALES CONFIGURADOS:\n');

const channels = {
    'Panel de Tickets': process.env.PANEL_CHANNEL_ID,
    'Logs': process.env.LOG_CHANNEL_ID,
    'Staff Chat': process.env.STAFF_CHAT_CHANNEL_ID,
    'CategorÃ­a Tickets Abiertos': process.env.TICKETS_OPEN_CHANNEL_ID,
    'CategorÃ­a Tickets Cerrados': process.env.TICKETS_CLOSED_CHANNEL_ID
};

let missingChannels = [];

for (const [name, id] of Object.entries(channels)) {
    if (id && id.trim() !== '') {
        console.log(`âœ… ${name.padEnd(30)} â†’ ${id}`);
    } else {
        console.log(`âš ï¸ ${name.padEnd(30)} â†’ NO CONFIGURADO`);
        if (name.includes('Panel') || name.includes('CategorÃ­a')) {
            missingChannels.push(name);
        }
    }
}

console.log('\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n');

// Resumen
console.log('ğŸ“Š RESUMEN:\n');
console.log(`âœ… Roles configurados: ${configuredRoles}/${Object.keys(roles).length}`);
console.log(`âš ï¸ Roles faltantes: ${missingRoles.length}`);

if (missingRoles.length > 0) {
    console.log('\nâŒ ROLES QUE DEBES CONFIGURAR:');
    missingRoles.forEach(role => {
        const envName = role.toUpperCase().replace(/ /g, '_') + '_ROLE_ID';
        console.log(`   â€¢ ${envName}`);
    });
}

if (missingChannels.length > 0) {
    console.log('\nâŒ CANALES CRÃTICOS QUE DEBES CONFIGURAR:');
    missingChannels.forEach(channel => {
        console.log(`   â€¢ ${channel}`);
    });
}

console.log('\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');

if (missingRoles.length === 0 && missingChannels.length === 0) {
    console.log('\nâœ… Â¡CONFIGURACIÃ“N COMPLETA! Tu bot estÃ¡ listo para funcionar.\n');
} else {
    console.log('\nâš ï¸ CONFIGURACIÃ“N INCOMPLETA');
    console.log('\nPasos para completar la configuraciÃ³n:');
    console.log('1. Abre tu archivo .env');
    console.log('2. Agrega las variables faltantes con sus IDs correspondientes');
    console.log('3. Para obtener IDs de Discord:');
    console.log('   â€¢ Activa el Modo Desarrollador en Discord');
    console.log('   â€¢ Clic derecho en roles/canales â†’ Copiar ID');
    console.log('4. Reinicia el bot despuÃ©s de editar el .env\n');
}

console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n');
